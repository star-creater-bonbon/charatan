<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>キャラたん！——これがあなたの誕生日！——</title>
<style>
body{
background: linear-gradient(#0f1020,#1b1e3a);
color: #f0f0f0;
font-family:"Hiragino Mincho ProN",serif;
text-align:center;
padding:30px;
}
.container{
max-width:800px;
margin:auto;
}
h1{
font-size:36px;
}
button{
margin-top:20px;
padding:10px 20px;
background:#2c2f4a;
color:white;
border:none;
cursor:pointer;
}
.result{
margin-top:30px;
padding:20px;
background:#1a1d33;
}
label{
display:inline-block;
margin:5px 10px;
}
</style>
</head>
<body>
<div class="container">
<h1>キャラたん！——これがあなたの誕生日！——</h1>

<p>キャラクター名：</p>
<input type="text" id="name" placeholder="キャラクター名"><br><br>

<p>性格を選んでください（複数可）</p>
<div id="traits">
<!-- JSで生成する -->
</div>

<p>光テーマを選んでください</p>
<div id="lightThemes"></div>

<p>闇テーマを選んでください</p>
<div id="darkThemes"></div>

<button onclick="diagnose()">誕生日を導き出す</button>

<div id="result" class="result"></div>
</div>

<script>

// ----------- データ -----------

// 12星座コア
const zodiacCore = {
aries:"迷わず前に出る人",
taurus:"一度決めたら、最後まで守る人",
gemini:"言葉で道を切り開く人",
cancer:"大切な人のために戦う人",
leo:"目立つことを恐れない人",
virgo:"小さな違和感を見逃さない人",
libra:"争いの間で答えを探す人",
scorpio:"本当のことを知ろうとする人",
sagittarius:"理想を追い続ける人",
capricorn:"上を目指して登り続ける人",
aquarius:"みんなと少し違う考えを持つ人",
pisces:"人の痛みに気づける人"
};

// 性格30項目
const traitData = {
"衝動的": { aries:5, sagittarius:3, leo:2 },
"慎重": { virgo:5, capricorn:4, cancer:2 },
"支配的": { leo:5, capricorn:4, aries:3 },
"協調的": { libra:5, cancer:4, pisces:3 },
"論理的": { virgo:5, aquarius:4, gemini:4 },
"感情的": { cancer:5, scorpio:4, pisces:4 },
"理想主義": { sagittarius:5, aquarius:4, pisces:3 },
"現実主義": { capricorn:5, taurus:4, virgo:4 },
"自己主張強い": { aries:5, leo:4, gemini:3 },
"自己抑制的": { capricorn:5, virgo:4, scorpio:3 },
"楽観的": { sagittarius:5, leo:4, gemini:3 },
"悲観的": { scorpio:5, capricorn:4, cancer:3 },
"自由奔放": { sagittarius:5, aquarius:4, gemini:4 },
"規律重視": { capricorn:5, virgo:4, taurus:3 },
"執着的": { scorpio:5, taurus:4, cancer:3 },
"切り替えが早い": { gemini:5, sagittarius:4, aquarius:3 },
"内向的": { cancer:4, scorpio:4, capricorn:3 },
"外向的": { leo:5, aries:4, gemini:3 },
"依存的": { pisces:5, cancer:4, libra:3 },
"自立的": { capricorn:5, aries:4, aquarius:3 },
"完璧主義": { virgo:5, capricorn:4, scorpio:3 },
"大雑把": { sagittarius:5, aries:3, leo:2 },
"秘密主義": { scorpio:5, capricorn:3, cancer:3 },
"開放的": { gemini:5, sagittarius:4, libra:3 },
"保守的": { taurus:5, capricorn:4, cancer:3 },
"革新的": { aquarius:5, gemini:4, sagittarius:3 },
"受動的": { pisces:4, libra:3, cancer:3 },
"能動的": { aries:5, leo:4, capricorn:3 },
"献身的": { pisces:5, cancer:4, virgo:3 },
"利己的": { leo:4, aries:4, scorpio:3 }
};

// 光テーマ
const lightThemes = {
"守護": {cancer:3, taurus:2, leo:2},
"革命": {aquarius:3, aries:2, sagittarius:2},
"栄光": {leo:3, capricorn:2, aries:2},
"救済": {pisces:3, sagittarius:2, libra:2},
"再生": {scorpio:3, pisces:2, cancer:2},
"真実追求": {scorpio:3, virgo:2, aquarius:2},
"自由": {sagittarius:3, aquarius:2, gemini:2},
"調和": {libra:3, pisces:2, cancer:2},
"理想実現": {sagittarius:3, capricorn:2, leo:2},
"継承": {capricorn:3, taurus:2, cancer:2}
};

// 闇テーマ
const darkThemes = {
"復讐心": {scorpio:3, aries:2, capricorn:2},
"孤独恐怖": {aquarius:3, cancer:2, capricorn:2},
"承認渇望": {leo:3, aries:2, libra:2},
"喪失恐怖": {cancer:3, taurus:2, scorpio:2},
"自己否定": {virgo:3, cancer:2, capricorn:2},
"依存恐怖": {pisces:3, cancer:2, libra:2},
"逃避傾向": {sagittarius:3, pisces:2, gemini:2},
"支配欲": {leo:3, capricorn:2, aries:2},
"無力恐怖": {capricorn:3, virgo:2, leo:2},
"裏切り不信": {scorpio:3, capricorn:2, gemini:1}
};

// 星座期間（日数）
const zodiacDays = {
aries:31, taurus:31, gemini:30, cancer:31, leo:31, virgo:30,
libra:31, scorpio:30, sagittarius:30, capricorn:31, aquarius:30, pisces:29
};

// ----------- UI生成 -----------

function createCheckboxes(containerId, data){
const div = document.getElementById(containerId);
for(let key in data){
const label = document.createElement("label");
label.innerHTML = `<input type="checkbox" value="${key}">${key}`;
div.appendChild(label);
}
}

createCheckboxes("traits", traitData);
createCheckboxes("lightThemes", lightThemes);
createCheckboxes("darkThemes", darkThemes);

// ----------- 診断ロジック -----------

function diagnose(){
const name = document.getElementById("name").value || "名もなき者";

// チェック取得
const selectedTraits = [...document.querySelectorAll("#traits input:checked")].map(i=>i.value);
const selectedLight = [...document.querySelectorAll("#lightThemes input:checked")].map(i=>i.value);
const selectedDark = [...document.querySelectorAll("#darkThemes input:checked")].map(i=>i.value);

if(selectedTraits.length<1 || selectedLight.length<1 || selectedDark.length<1){
alert("すべて選択してください");
return;
}

// スコア計算
let scores = {};
function addScore(source){
for(let key of source){
const data = (traitData[key] || lightThemes[key] || darkThemes[key]);
for(let z in data){
scores[z] = (scores[z]||0) + data[z];
}
}
}
addScore(selectedTraits);
addScore(selectedLight);
addScore(selectedDark);

// 上位星座1位を決定
let sorted = Object.keys(scores).sort((a,b)=>scores[b]-scores[a]);
const mainSign = sorted[0];

// 日付計算
const totalScore = Object.values(scores).reduce((a,b)=>a+b,0);
const day = (totalScore % zodiacDays[mainSign]) + 1;

// 結果文章
const signText = zodiacCore[mainSign];
const lightText = selectedLight.map(l=>`あなたは、${l}したいと願っている。`).join(" ");
const darkText = selectedDark.map(d=>`でも、${d}が心を縛ることがある。`).join(" ");

const story = `${name}の星は${mainSign}です。
${signText}
${lightText}
${darkText}
それでも星は光と影を抱えながら進んでいく。
誕生日は${day}日です。`;

document.getElementById("result").innerText = story;
}

</script>
</body>
</html>
